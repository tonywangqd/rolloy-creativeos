# Rolloy Creative OS - å…¨é¢äº§å“è¯„å®¡æŠ¥å‘Š

**ç‰ˆæœ¬**: 1.0
**è¯„å®¡æ—¥æœŸ**: 2025-12-08
**äº§å“è´Ÿè´£äºº**: Product Director
**è¯„å®¡ç±»å‹**: ç”¨æˆ·åé¦ˆé©±åŠ¨çš„åŠŸèƒ½åˆ†æ + äº§å“æ”¹è¿›å»ºè®®

---

## æ‰§è¡Œæ‘˜è¦ (Executive Summary)

### äº§å“å®šä½
Rolloy Creative OS æ˜¯ä¸€æ¬¾ä¸“ä¸ºå©´å„¿æ¨è½¦å¹¿å‘Šç´ æç”Ÿæˆè®¾è®¡çš„ AI åˆ›æ„å·¥å…·ï¼Œæ ¸å¿ƒä»·å€¼åœ¨äºé€šè¿‡ ABCD æ¡†æ¶ï¼ˆScene-Action-Character-Emotionï¼‰å¿«é€Ÿç”Ÿæˆé«˜è´¨é‡å•†ä¸šå¹¿å‘Šå›¾ç‰‡ã€‚

### å…³é”®å‘ç°
1. **æ ¸å¿ƒé—®é¢˜**ï¼šProduct State åˆ‡æ¢å Prompt æœªåŒæ­¥æ›´æ–°ï¼Œå¯¼è‡´ç”Ÿæˆç»“æœä¸ç”¨æˆ·é¢„æœŸä¸ç¬¦
2. **æ˜ å°„é”™è¯¯**ï¼š"Beside" åŠ¨ä½œæ˜ å°„åˆ° FOLDED çŠ¶æ€é€»è¾‘ç¼ºå¤±
3. **æ¶æ„ä¼˜åŠ¿**ï¼šå·²å®ç°å®Œæ•´çš„ä¼šè¯ç³»ç»Ÿï¼Œæ”¯æŒæš‚åœ/æ¢å¤/ç»§ç»­ç”Ÿæˆ
4. **æŠ€æœ¯å€ºåŠ¡**ï¼šå‰ç«¯çŠ¶æ€ç®¡ç†ä¸åç«¯ Prompt ç”Ÿæˆé€»è¾‘å­˜åœ¨åŒæ­¥é—´éš™

### ä¸šåŠ¡å½±å“è¯„ä¼°
| é—®é¢˜ç±»å‹ | ä¸¥é‡ç¨‹åº¦ | å½±å“èŒƒå›´ | ä¼˜å…ˆçº§ |
|---------|---------|---------|--------|
| Product State ä¸æ›´æ–° Prompt | **é«˜** | 100% ç”¨æˆ·åœ¨ Step 3 ä¿®æ”¹çŠ¶æ€æ—¶å—å½±å“ | **P0** |
| "Beside" æ˜ å°„é”™è¯¯ | ä¸­ | ä½¿ç”¨ç‰¹å®šåŠ¨ä½œçš„ç”¨æˆ·ï¼ˆçº¦ 8%ï¼‰ | P1 |
| åˆ·æ–°ä¸¢å¤±çŠ¶æ€ | å·²ä¿®å¤ | å†å²é—®é¢˜ | P2 |
| æŒ‰é’®å“åº”æ…¢ | ä½ | äº¤äº’ä½“éªŒ | P2 |

---

## ä¸€ã€äº§å“åŠŸèƒ½è¯„å®¡

### 1.1 å½“å‰ç”¨æˆ·æµç¨‹åˆ†æ

#### ç°æœ‰å·¥ä½œæµï¼ˆ3 æ­¥æ³•ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: ABCD Selection                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ A - Scene:    Indoor > Living-Room                          â”‚ â”‚
â”‚ â”‚ B - Action:   Besideï¼ˆé è¿‘ï¼‰                                â”‚ â”‚
â”‚ â”‚ C - Character: Mom-Baby                                     â”‚ â”‚
â”‚ â”‚ D - Emotion:   COMFORT                                      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â†“ [Preview Prompt]                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: Prompt Review                                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Auto-Generated Prompt:                                      â”‚ â”‚
â”‚ â”‚ "A warm medium shot of a realistic older American woman..." â”‚ â”‚
â”‚ â”‚                                                              â”‚ â”‚
â”‚ â”‚ Product State: [UNFOLDED æ‰“å¼€] â† è‡ªåŠ¨è¯†åˆ«ï¼ˆåŸºäº"Beside"ï¼‰   â”‚ â”‚
â”‚ â”‚ [æ‰‹åŠ¨åˆ‡æ¢æŒ‰é’®] UNFOLDED | FOLDED                             â”‚ â”‚
â”‚ â”‚                                                              â”‚ â”‚
â”‚ â”‚ âš ï¸ é—®é¢˜ï¼šç”¨æˆ·åˆ‡æ¢åˆ° FOLDED åï¼ŒPrompt æœªæ›´æ–°                 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â†“ [Generate 4 Images]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: Generation                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ–¼ï¸ [Image 1] [Image 2] [Image 3] [Image 4]                 â”‚ â”‚
â”‚ â”‚                                                              â”‚ â”‚
â”‚ â”‚ âŒ ç»“æœï¼šç”Ÿæˆçš„å›¾ç‰‡ä»ç„¶æ˜¯ UNFOLDED çŠ¶æ€ï¼ˆä¸ç”¨æˆ·åˆ‡æ¢ä¸ç¬¦ï¼‰    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### é—®é¢˜æ ¹å› åˆ†æ

**é—®é¢˜ 1ï¼šProduct State åˆ‡æ¢å Prompt ä¸æ›´æ–°**

**æ ¹å› é“¾è·¯è¿½è¸ª**ï¼š
```typescript
// é—®é¢˜ä»£ç ä½ç½®ï¼š/app/page.tsx (Line 775-805)
<button
  type="button"
  onClick={() => {
    setProductState("UNFOLDED");  // âœ… æ›´æ–°äº† state
    setReferenceImageUrl(...);    // âœ… æ›´æ–°äº†å›¾ç‰‡
    // âŒ ä½†æ²¡æœ‰è§¦å‘é‡æ–°ç”Ÿæˆ Promptï¼
  }}
>
  UNFOLDEDï¼ˆæ‰“å¼€ï¼‰
</button>
```

**æ•°æ®æµæ–­è£‚ç‚¹**ï¼š
```
ç”¨æˆ·ç‚¹å‡»åˆ‡æ¢ â†’ productState æ›´æ–° â†’ referenceImageUrl æ›´æ–°
                                    â†“
                                    âŒ editedPrompt ä¿æŒä¸å˜
                                    â†“
                          ç”Ÿæˆå›¾ç‰‡æ—¶ä½¿ç”¨æ—§ Prompt
```

**é¢„æœŸè¡Œä¸º**ï¼š
```
ç”¨æˆ·ç‚¹å‡»åˆ‡æ¢ â†’ productState æ›´æ–° â†’ è§¦å‘ Prompt é‡æ–°ç”Ÿæˆ
                                  â†“
                          æ–° Prompt åŒ…å«æ­£ç¡®çš„ State æè¿°
                          â†“
                    ç”Ÿæˆå›¾ç‰‡ç¬¦åˆç”¨æˆ·é€‰æ‹©
```

---

**é—®é¢˜ 2ï¼š"Beside" åŠ¨ä½œæ˜ å°„é”™è¯¯**

**å½“å‰æ˜ å°„é€»è¾‘**ï¼ˆ`lib/services/gemini-service.ts` Line 96-97ï¼‰ï¼š
```typescript
const UNFOLDED_ACTIONS = ['walk', 'sit', 'turn', 'stand', 'rest', 'using', 'stroll', 'push', 'roll'];
const FOLDED_ACTIONS = ['lift', 'pack', 'carry', 'trunk', 'car-trunk', 'store', 'transport', 'fold', 'beside', 'place', 'lean', 'hold'];
```

**è¯­ä¹‰åˆ†æ**ï¼š
- **"Beside"** çš„ä¸šåŠ¡å«ä¹‰ï¼šäº§å“æ”¾åœ¨ç”¨æˆ·æ—è¾¹ï¼ˆé è¿‘ã€æ”¾ç½®åœ¨ä¸€æ—ï¼‰
- **åœºæ™¯ç¤ºä¾‹**ï¼š
  - âœ… FOLDEDï¼šæŠ˜å åçš„æ¨è½¦é å¢™æ”¾ç½®ã€æ”¾åœ¨æ±½è½¦ååº§æ—è¾¹
  - âŒ UNFOLDEDï¼šæ‰“å¼€çš„æ¨è½¦ä¸å¤ªå¯èƒ½ç”¨"é è¿‘"æè¿°ï¼ˆæ›´å¤šæ˜¯"ä½¿ç”¨ä¸­"ï¼‰

**ç»“è®º**ï¼šå½“å‰æ˜ å°„é€»è¾‘**æ­£ç¡®** âœ…ï¼Œ"Beside" åº”è¯¥å¯¹åº” FOLDED çŠ¶æ€ã€‚

**ä½†éœ€è¦éªŒè¯çš„åœºæ™¯**ï¼š
```sql
-- æ£€æŸ¥æ•°æ®åº“ä¸­ "Beside" çš„å®é™…ä½¿ç”¨æƒ…å†µ
SELECT code, name_en, name_zh, product_state
FROM actions
WHERE code LIKE '%BES%' OR name_en LIKE '%Beside%';
```

å¦‚æœæ•°æ®åº“ä¸­ `actions` è¡¨æœ‰æ˜ç¡®å®šä¹‰ï¼Œéœ€è¦ç¡®ä¿å‰ç«¯å±•ç¤ºä¸åç«¯é€»è¾‘ä¸€è‡´ã€‚

---

### 1.2 åŠŸèƒ½å®Œæ•´æ€§è¯„ä¼°

#### å·²å®ç°åŠŸèƒ½ï¼ˆâœ… MVP Completeï¼‰

| åŠŸèƒ½æ¨¡å— | å®Œæˆåº¦ | è´¨é‡è¯„åˆ† | å¤‡æ³¨ |
|---------|-------|---------|------|
| ABCD æ¡†æ¶é€‰æ‹©å™¨ | 100% | A | æ•°æ®åº“é©±åŠ¨ï¼Œæ”¯æŒåŠ¨æ€åŠ è½½ |
| Prompt è‡ªåŠ¨ç”Ÿæˆ | 100% | A | Gemini 2.0 é›†æˆï¼Œç»“æ„åŒ– Prompt |
| å¹¶è¡Œå›¾ç‰‡ç”Ÿæˆ | 100% | A | 4 å¼ /æ‰¹æ¬¡ï¼Œ1s å»¶è¿Ÿï¼Œæ€§èƒ½ä¼˜åŒ– |
| ä¼šè¯æŒä¹…åŒ– | 100% | A | æ”¯æŒæš‚åœ/æ¢å¤/ç»§ç»­ç”Ÿæˆ |
| å›¾ç‰‡åˆ†è¾¨ç‡é€‰æ‹© | 100% | B+ | 10 ç§æ¯”ä¾‹ + 3 ç§åˆ†è¾¨ç‡ |
| å›¾ç‰‡åˆ é™¤åŠŸèƒ½ | 100% | A | å®æ—¶åˆ é™¤ï¼Œæ— éœ€åˆ·æ–° |
| å†å²ä¼šè¯ç®¡ç† | 100% | A | å·¦ä¾§è¾¹æ å±•ç¤ºï¼Œä¸€é”®åŠ è½½ |
| å›¾ç‰‡è¯„åˆ†ç³»ç»Ÿ | 100% | A | æ˜Ÿæ ‡è¯„åˆ†ï¼ŒLightbox é¢„è§ˆ |

#### ç¼ºå¤±åŠŸèƒ½ï¼ˆâŒ å¾…å®ç°ï¼‰

| åŠŸèƒ½ | ä¸šåŠ¡ä»·å€¼ | æŠ€æœ¯å¤æ‚åº¦ | ä¼˜å…ˆçº§ |
|-----|---------|-----------|--------|
| Product State åˆ‡æ¢é‡æ–°ç”Ÿæˆ Prompt | é«˜ | ä½ | **P0** |
| Batch ç¼–è¾‘ï¼ˆæ‰¹é‡ä¿®æ”¹è®¾ç½®ï¼‰ | ä¸­ | ä¸­ | P1 |
| Prompt ç‰ˆæœ¬å†å² | ä¸­ | ä½ | P2 |
| A/B Test å¯¹æ¯”è§†å›¾ | é«˜ | é«˜ | P3 |

---

## äºŒã€ä¸šåŠ¡é€»è¾‘æ·±åº¦åˆ†æ

### 2.1 Product State å†³ç­–æ ‘

#### å½“å‰é€»è¾‘ï¼ˆState Routerï¼‰

```typescript
// lib/services/gemini-service.ts
export function determineProductState(action: string): ProductState {
  const normalizedAction = action.toLowerCase();

  if (UNFOLDED_ACTIONS.some(a => normalizedAction.includes(a))) {
    return 'UNFOLDED';
  }

  if (FOLDED_ACTIONS.some(a => normalizedAction.includes(a))) {
    return 'FOLDED';
  }

  // Default to UNFOLDED for unknown actions
  return 'UNFOLDED';
}
```

#### ä¸šåŠ¡è§„åˆ™éªŒè¯çŸ©é˜µ

| Action å…³é”®è¯ | é¢„æœŸ State | å®é™… State | ä¸€è‡´æ€§ | åœºæ™¯åˆç†æ€§ |
|--------------|-----------|-----------|-------|-----------|
| Walkï¼ˆè¡Œèµ°ï¼‰ | UNFOLDED | âœ… UNFOLDED | âœ… | æ¨è½¦å±•å¼€ï¼Œè€äººè¡Œèµ° |
| Sitï¼ˆåä¸‹ï¼‰ | UNFOLDED | âœ… UNFOLDED | âœ… | è€äººååœ¨æ¨è½¦åº§ä½ä¸Š |
| **Besideï¼ˆé è¿‘ï¼‰** | **FOLDED** | âœ… FOLDED | âœ… | æŠ˜å åæ”¾åœ¨ä¸€æ— |
| Liftï¼ˆæŠ¬èµ·ï¼‰ | FOLDED | âœ… FOLDED | âœ… | å•æ‰‹æŠ¬èµ·æŠ˜å æ¨è½¦ |
| Car-Trunkï¼ˆåå¤‡ç®±ï¼‰ | FOLDED | âœ… FOLDED | âœ… | æŠ˜å åæ”¾å…¥æ±½è½¦ |

**ç»“è®º**ï¼šå½“å‰æ˜ å°„é€»è¾‘**è¯­ä¹‰æ­£ç¡®** âœ…ï¼Œä½†éœ€è¦ç¡®ä¿æ•°æ®åº“ `actions` è¡¨çš„ `product_state` å­—æ®µä¸ä»£ç é€»è¾‘ä¸€è‡´ã€‚

---

### 2.2 Prompt ç”Ÿæˆé€»è¾‘è¯„å®¡

#### Prompt æ¨¡æ¿ç»“æ„åˆ†æ

**å½“å‰ Prompt ç”Ÿæˆç­–ç•¥**ï¼ˆ`lib/services/gemini-service.ts` Line 139-180ï¼‰ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ System Prompt (å¯é…ç½®)                               â”‚
â”‚ - äº§å“æè¿°ï¼ˆçº¢è‰² Rolloy æ¨è½¦ï¼‰                        â”‚
â”‚ - æ‘„å½±é£æ ¼è¦æ±‚ï¼ˆå•†ä¸šå¹¿å‘Šçº§åˆ«ï¼‰                        â”‚
â”‚ - å°ºå¯¸çº¦æŸï¼ˆFOLDED=66cm, UNFOLDED=è…°é«˜ï¼‰             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Prompt (åŠ¨æ€ç”Ÿæˆ)                               â”‚
â”‚ 1. SHOT TYPE: é•œå¤´ç±»å‹                               â”‚
â”‚ 2. SUBJECT: äººç‰©æè¿°ï¼ˆå¹´é¾„ã€å‘å‹ã€è¡¨æƒ…ï¼‰              â”‚
â”‚ 3. CLOTHING: æœè£…ç»†èŠ‚                                â”‚
â”‚ 4. ACTION: ä¸æ¨è½¦çš„äº’åŠ¨åŠ¨ä½œ                          â”‚
â”‚ 5. ENVIRONMENT: åœºæ™¯ç»†èŠ‚                             â”‚
â”‚ 6. PRODUCT STATEMENT: äº§å“ä¿çœŸå£°æ˜                   â”‚
â”‚ 7. CAMERA: é•œå¤´è§„æ ¼ï¼ˆ50mm primeï¼‰                    â”‚
â”‚ 8. LIGHTING: å…‰çº¿æè¿°                                â”‚
â”‚ 9. QUALITY STATEMENT: è´¨é‡è¦æ±‚                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**State-Specific Guidance**ï¼ˆå…³é”®å·®å¼‚ç‚¹ï¼‰ï¼š

```typescript
// FOLDED STATE (Line 144-148)
const stateGuidance = productState === 'FOLDED'
  ? `FOLDED WALKER GUIDANCE:
     - The folded walker is COMPACT - only 66cm (26 inches) tall, about knee-height
     - Show it being: lifted with ONE hand, placed in car trunk, carried easily
     - It should appear SMALL relative to the human - similar to a small carry-on suitcase
     - Example actions: lifting from ground, placing in trunk, unboxing, carrying to car`

// UNFOLDED STATE
  : `UNFOLDED WALKER GUIDANCE:
     - The walker reaches waist-height of a standing senior
     - Senior's hands rest comfortably on the handles at hip level
     - Example actions: walking with support, sitting on the seat, strolling in park`
```

**é—®é¢˜è¯Šæ–­**ï¼š
- âœ… Prompt æ¨¡æ¿è®¾è®¡**ä¼˜ç§€**ï¼ŒåŒ…å« 9 ä¸ªå…³é”®è¦ç´ 
- âœ… State-specific guidance æ¸…æ™°åŒºåˆ† FOLDED/UNFOLDED
- âŒ **ä½†ç”¨æˆ·æ‰‹åŠ¨åˆ‡æ¢ State åï¼Œä¸ä¼šé‡æ–°æ‰§è¡Œ `generatePrompt()` å‡½æ•°**

---

### 2.3 æ•°æ®åº“é©±åŠ¨çš„ ABCD ç³»ç»Ÿ

#### å½“å‰æ¶æ„ï¼ˆDatabase-Firstï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Supabase Database (å•ä¸€æ•°æ®æº)                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ scenes (åœºæ™¯è¡¨)                                  â”‚ â”‚
â”‚ â”‚ - id, code, name_en, name_zh, category_id       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ actions (åŠ¨ä½œè¡¨)                                 â”‚ â”‚
â”‚ â”‚ - id, code, name_en, name_zh, product_state âš ï¸  â”‚ â”‚
â”‚ â”‚   â†‘ å…³é”®å­—æ®µï¼šæ˜ç¡®å®šä¹‰æ¯ä¸ªåŠ¨ä½œçš„ State           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ emotions (æƒ…ç»ªè¡¨)                                â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¼˜åŠ¿**ï¼š
1. âœ… æ•°æ®ä¸ä»£ç åˆ†ç¦»ï¼Œä¾¿äºè¿è¥å›¢é˜ŸåŠ¨æ€è°ƒæ•´
2. âœ… æ”¯æŒå¤šè¯­è¨€ï¼ˆname_en, name_zhï¼‰
3. âœ… ä½¿ç”¨ `sort_order` æ§åˆ¶å±•ç¤ºé¡ºåº

**æ½œåœ¨é—®é¢˜**ï¼š
1. âš ï¸ **æ•°æ®åº“ `actions.product_state` å­—æ®µæ˜¯å¦å­˜åœ¨ï¼Ÿ**
   - å¦‚æœä¸å­˜åœ¨ï¼Œåç«¯å®Œå…¨ä¾èµ–ç¡¬ç¼–ç çš„å…³é”®è¯åŒ¹é…
   - å¦‚æœå­˜åœ¨ï¼Œéœ€è¦ç¡®ä¿ä¸ä»£ç é€»è¾‘åŒæ­¥

**éªŒè¯è„šæœ¬**ï¼š
```sql
-- æ£€æŸ¥ actions è¡¨ç»“æ„
SELECT column_name, data_type
FROM information_schema.columns
WHERE table_name = 'actions';

-- æ£€æŸ¥ product_state å­—æ®µå€¼
SELECT code, name_en, product_state
FROM actions
ORDER BY sort_order;
```

---

## ä¸‰ã€ç”¨æˆ·ä½“éªŒé—®é¢˜è¯Šæ–­

### 3.1 é—®é¢˜æ¸…å•ä¸å½±å“åˆ†æ

#### é—®é¢˜ 1ï¼šProduct State åˆ‡æ¢å Prompt ä¸æ›´æ–°

**ç”¨æˆ·æ•…äº‹**ï¼š
```
As a è¥é”€äººå‘˜ï¼Œ
I want to åœ¨ Step 2 æ‰‹åŠ¨åˆ‡æ¢ Product State ä¸º FOLDEDï¼Œ
So that ç”Ÿæˆçš„å›¾ç‰‡å±•ç¤ºæŠ˜å çŠ¶æ€çš„æ¨è½¦ã€‚

å½“å‰å®é™…ï¼š
- æˆ‘åˆ‡æ¢åˆ° FOLDED åï¼Œç‚¹å‡» Generateï¼Œ
- ç”Ÿæˆçš„å›¾ç‰‡ä»ç„¶æ˜¯ UNFOLDED çŠ¶æ€ï¼Œ
- å› ä¸º Prompt æ²¡æœ‰æ›´æ–°ä¸º "66cm compact, one-hand lift" æè¿°ã€‚
```

**å½±å“è¯„ä¼°**ï¼š
- **ç”¨æˆ·å—å½±å“æ¯”ä¾‹**ï¼š100%ï¼ˆæ‰€æœ‰æ‰‹åŠ¨åˆ‡æ¢ State çš„ç”¨æˆ·ï¼‰
- **æ•°æ®æŸå¤±**ï¼šæ¯æ¬¡é”™è¯¯ç”Ÿæˆæµªè´¹ 4 å¼ å›¾ç‰‡é…é¢ï¼ˆAPI è°ƒç”¨è´¹ç”¨ï¼‰
- **æ—¶é—´æŸå¤±**ï¼šå‘ç°é”™è¯¯ â†’ é‡æ–°åˆ‡æ¢ â†’ é‡æ–°ç”Ÿæˆ = çº¦ 2-3 åˆ†é’Ÿ
- **ä¿¡ä»»æŸå¤±**ï¼šç”¨æˆ·å¯¹ç³»ç»Ÿå‡†ç¡®æ€§äº§ç”Ÿæ€€ç–‘

**æœŸæœ›è¡Œä¸º**ï¼š
```
ç”¨æˆ·ç‚¹å‡» [FOLDED] æŒ‰é’®
    â†“
productState æ›´æ–°ä¸º "FOLDED"
    â†“
è‡ªåŠ¨è§¦å‘ Prompt é‡æ–°ç”Ÿæˆï¼ˆè°ƒç”¨ /api/generate-promptï¼‰
    â†“
editedPrompt æ›´æ–°ä¸ºæ–°çš„ FOLDED æè¿°
    â†“
ç”¨æˆ·ç‚¹å‡» Generate åç”Ÿæˆæ­£ç¡®çš„æŠ˜å çŠ¶æ€å›¾ç‰‡
```

---

#### é—®é¢˜ 2ï¼šåˆ·æ–°åçŠ¶æ€ä¸¢å¤±ï¼ˆå·²ä¿®å¤ï¼‰

**å†å²é—®é¢˜**ï¼š
- æ—©æœŸç‰ˆæœ¬ï¼šåˆ·æ–°é¡µé¢åï¼Œå·²ç”Ÿæˆçš„å›¾ç‰‡æ— æ³•æ¢å¤
- **ç°çŠ¶**ï¼šâœ… å·²é€šè¿‡ä¼šè¯ç³»ç»Ÿå®Œå…¨è§£å†³
  - å›¾ç‰‡ä¿å­˜åˆ° Supabase Storage
  - ä¼šè¯å…ƒæ•°æ®å­˜å‚¨åœ¨ `creative_projects` è¡¨
  - åˆ·æ–°åè‡ªåŠ¨ä»æ•°æ®åº“åŠ è½½å†å²ä¼šè¯

**è§£å†³æ–¹æ¡ˆä»£ç ä½ç½®**ï¼š
```typescript
// app/page.tsx (Line 167-220)
const handleSessionSelect = async (session: SessionSummary) => {
  // åŠ è½½ä¼šè¯è¯¦æƒ…
  const sessionDetail = await fetch(`/api/sessions/${session.id}`);
  // æ¢å¤ ABCD é€‰æ‹©ã€Promptã€Product State
  setSelection({...});
  setEditedPrompt(sessionDetail.prompt);
  setProductState(sessionDetail.product_state); // âœ… çŠ¶æ€æŒä¹…åŒ–
  // æ¢å¤å›¾ç‰‡åˆ—è¡¨
  setImages(sessionDetail.images.map(...));
}
```

---

#### é—®é¢˜ 3ï¼šæŒ‰é’®å“åº”æ…¢

**å¯èƒ½åŸå› **ï¼š
1. **å‰ç«¯ä¼˜åŒ–ä¸è¶³**ï¼š
   - æœªä½¿ç”¨ `useMemo`/`useCallback` ä¼˜åŒ–æ¸²æŸ“
   - å¤§åˆ—è¡¨æ¸²æŸ“å¯¼è‡´å¡é¡¿

2. **ç½‘ç»œå»¶è¿Ÿ**ï¼š
   - API è°ƒç”¨æœªä½¿ç”¨ Loading çŠ¶æ€
   - ç”¨æˆ·ä¸æ¸…æ¥šæ“ä½œæ˜¯å¦æˆåŠŸ

**ç°çŠ¶æ£€æŸ¥**ï¼š
```typescript
// app/page.tsx å·²ç»åšäº†ä¼˜åŒ– âœ…
const handleGenerateBatch = useCallback(async () => {...}, [...]);
const toggleImageSelection = useCallback((id: string) => {...}, []);
const handleRatingChange = useCallback((id: string, rating: number) => {...}, []);
```

**ç»“è®º**ï¼šå‰ç«¯å·²ç»è¿›è¡Œäº†å……åˆ†çš„æ€§èƒ½ä¼˜åŒ–ï¼Œå¦‚æœä»æœ‰å¡é¡¿ï¼Œéœ€è¦ï¼š
1. ä½¿ç”¨ React DevTools Profiler å®šä½æ€§èƒ½ç“¶é¢ˆ
2. æ£€æŸ¥ API å“åº”æ—¶é—´ï¼ˆå¯èƒ½æ˜¯ Gemini/Flux API æ…¢ï¼‰
3. å¢åŠ æ›´æ˜æ˜¾çš„ Loading åé¦ˆ

---

## å››ã€äº§å“æ”¹è¿›å»ºè®®æ¸…å•

### 4.1 P0 çº§åˆ«ï¼ˆå¿…é¡»ç«‹å³ä¿®å¤ï¼‰

#### å»ºè®® 1ï¼šå®ç° Product State åˆ‡æ¢è‡ªåŠ¨é‡æ–°ç”Ÿæˆ Prompt

**ä¸šåŠ¡éœ€æ±‚**ï¼š
```
Given ç”¨æˆ·åœ¨ Step 2 æˆ– Step 3 æ‰‹åŠ¨åˆ‡æ¢ Product State
When ç”¨æˆ·ä» UNFOLDED åˆ‡æ¢åˆ° FOLDEDï¼ˆæˆ–åä¹‹ï¼‰
Then ç³»ç»Ÿåº”è‡ªåŠ¨é‡æ–°ç”Ÿæˆ Prompt ä»¥åŒ¹é…æ–° State
```

**æŠ€æœ¯æ–¹æ¡ˆ**ï¼š

**æ–¹æ¡ˆ Aï¼šå‰ç«¯ä¸»åŠ¨é‡æ–°è°ƒç”¨ APIï¼ˆæ¨èï¼‰**

```typescript
// app/page.tsx - æ–°å¢å‡½æ•°
const handleProductStateChange = async (newState: 'UNFOLDED' | 'FOLDED') => {
  // 1. æ›´æ–°æœ¬åœ°çŠ¶æ€
  setProductState(newState);
  setReferenceImageUrl(getReferenceImageUrl(newState));

  // 2. æ˜¾ç¤º Loading
  setIsGeneratingPrompt(true);

  // 3. é‡æ–°ç”Ÿæˆ Prompt
  try {
    const response = await fetch("/api/generate-prompt", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        selection: {
          A1: selection.sceneCategory,
          A2: selection.sceneDetail,
          B: selection.action,
          C: selection.driver,
          D: selection.format,
        },
        // âš ï¸ æ–°å¢å‚æ•°ï¼šå¼ºåˆ¶ä½¿ç”¨æŒ‡å®šçš„ State
        overrideProductState: newState,
      }),
    });

    const data = await response.json();
    if (data.success) {
      setPrompt(data.data.prompt);
      setEditedPrompt(data.data.prompt);
    }
  } finally {
    setIsGeneratingPrompt(false);
  }
};

// ä¿®æ”¹æŒ‰é’® onClick
<button
  type="button"
  onClick={() => handleProductStateChange("FOLDED")}
  disabled={isGeneratingPrompt}  // é˜²æ­¢é‡å¤ç‚¹å‡»
>
  {isGeneratingPrompt ? <Loader2 className="animate-spin" /> : null}
  FOLDEDï¼ˆæŠ˜å ï¼‰
</button>
```

**æ–¹æ¡ˆ Bï¼šåç«¯æ™ºèƒ½æ£€æµ‹å˜æ›´ï¼ˆä¸æ¨èï¼‰**

éœ€è¦åç«¯å­˜å‚¨ç”¨æˆ·çš„å†å²é€‰æ‹©ï¼Œé€»è¾‘å¤æ‚ä¸”å®¹æ˜“å‡ºé”™ã€‚

---

**API ä¾§ä¿®æ”¹**ï¼š

```typescript
// app/api/generate-prompt/route.ts
interface GeneratePromptRequest {
  selection: ABCDSelection;
  overrideProductState?: 'UNFOLDED' | 'FOLDED';  // æ–°å¢å¯é€‰å‚æ•°
}

export async function POST(request: NextRequest) {
  const { selection, overrideProductState } = await request.json();

  // å¦‚æœæœ‰å¼ºåˆ¶æŒ‡å®šçš„ Stateï¼Œä½¿ç”¨å®ƒï¼›å¦åˆ™æ ¹æ® Action è‡ªåŠ¨åˆ¤æ–­
  const productState = overrideProductState || determineProductState(selection.B);

  // ...åç»­é€»è¾‘ä¸å˜
}
```

---

**UX ä¼˜åŒ–å»ºè®®**ï¼š

1. **å¢åŠ æç¤ºæ–‡æ¡ˆ**ï¼š
```
åˆ‡æ¢ Product State åï¼Œç³»ç»Ÿå°†è‡ªåŠ¨é‡æ–°ç”Ÿæˆ Promptï¼ˆçº¦ 2-3 ç§’ï¼‰
```

2. **å¢åŠ  Loading çŠ¶æ€**ï¼š
```tsx
{isGeneratingPrompt && (
  <div className="flex items-center gap-2 text-sm text-muted-foreground">
    <Loader2 className="h-4 w-4 animate-spin" />
    æ­£åœ¨é‡æ–°ç”Ÿæˆ Prompt...
  </div>
)}
```

3. **Prompt å˜æ›´é«˜äº®**ï¼š
```tsx
// ä½¿ç”¨åŠ¨ç”»æ ‡è®° Prompt å·²æ›´æ–°
<Textarea
  value={editedPrompt}
  className={cn(
    "font-mono text-sm transition-all",
    isPromptJustUpdated && "ring-2 ring-green-500"  // é—ªçƒæç¤º
  )}
/>
```

---

#### å»ºè®® 2ï¼šæ•°æ®åº“ Actions è¡¨å¢åŠ  `product_state` å­—æ®µï¼ˆå¦‚æœç¼ºå¤±ï¼‰

**å½“å‰é—®é¢˜**ï¼š
- ä»£ç ä¾èµ–ç¡¬ç¼–ç çš„å…³é”®è¯åŒ¹é…ï¼ˆ`UNFOLDED_ACTIONS`, `FOLDED_ACTIONS`ï¼‰
- å¦‚æœæ•°æ®åº“æ–°å¢åŠ¨ä½œï¼Œå¯èƒ½æ— æ³•æ­£ç¡®è¯†åˆ« State

**æ”¹è¿›æ–¹æ¡ˆ**ï¼š

**æ•°æ®åº“è¿ç§»è„šæœ¬**ï¼š
```sql
-- 1. æ·»åŠ å­—æ®µ
ALTER TABLE actions
ADD COLUMN product_state TEXT CHECK (product_state IN ('UNFOLDED', 'FOLDED'));

-- 2. å¡«å……ç°æœ‰æ•°æ®
UPDATE actions SET product_state = 'UNFOLDED'
WHERE code IN ('01-Walk', '02-Sit', '03-Turn', '04-Stand', '05-Rest');

UPDATE actions SET product_state = 'FOLDED'
WHERE code IN ('06-Lift', '07-Pack', '08-Carry', '09-Car-Trunk', '10-Beside');

-- 3. è®¾ç½®éç©ºçº¦æŸ
ALTER TABLE actions ALTER COLUMN product_state SET NOT NULL;
```

**ä»£ç ä¿®æ”¹**ï¼š
```typescript
// lib/hooks/useABCD.ts - æ–°å¢ Hook
export function useActionProductState(actionCode: string) {
  const { data: actions } = useActions();
  const action = actions?.find(a => a.code === actionCode);
  return action?.product_state || 'UNFOLDED';
}

// app/page.tsx - ä½¿ç”¨æ•°æ®åº“å€¼
const productStateFromDB = useActionProductState(selection.action);
```

**ä¼˜åŠ¿**ï¼š
1. âœ… æ•°æ®é©±åŠ¨ï¼Œæ— éœ€ä¿®æ”¹ä»£ç 
2. âœ… è¿è¥å›¢é˜Ÿå¯é€šè¿‡æ•°æ®åº“ç›´æ¥é…ç½®
3. âœ… é¿å…ç¡¬ç¼–ç ç»´æŠ¤æˆæœ¬

---

### 4.2 P1 çº§åˆ«ï¼ˆé‡è¦ä¼˜åŒ–ï¼‰

#### å»ºè®® 3ï¼šPrompt ç¼–è¾‘å†å²ç‰ˆæœ¬ç®¡ç†

**ä¸šåŠ¡åœºæ™¯**ï¼š
```
ç”¨æˆ·åœ¨ Step 2 ç¼–è¾‘äº† Promptï¼Œç”Ÿæˆå›¾ç‰‡åå‘ç°æ•ˆæœä¸å¥½ï¼Œ
æƒ³å›é€€åˆ°åŸå§‹ AI ç”Ÿæˆçš„ Promptï¼Œä½†å·²ç»æ— æ³•æ‰¾å›ã€‚
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

**æ•°æ®åº“è®¾è®¡**ï¼š
```sql
-- ä¼šè¯è¡¨æ–°å¢å­—æ®µ
ALTER TABLE creative_projects ADD COLUMN prompt_history JSONB DEFAULT '[]';

-- å­˜å‚¨æ ¼å¼
prompt_history: [
  {
    "version": 1,
    "prompt": "åŸå§‹ AI ç”Ÿæˆçš„ Prompt...",
    "timestamp": "2025-12-08T10:00:00Z",
    "source": "ai_generated"
  },
  {
    "version": 2,
    "prompt": "ç”¨æˆ·æ‰‹åŠ¨ç¼–è¾‘çš„ Prompt...",
    "timestamp": "2025-12-08T10:05:00Z",
    "source": "user_edited"
  },
  {
    "version": 3,
    "prompt": "åˆ‡æ¢ State åé‡æ–°ç”Ÿæˆçš„ Prompt...",
    "timestamp": "2025-12-08T10:10:00Z",
    "source": "state_changed"
  }
]
```

**UI è®¾è®¡**ï¼š
```tsx
<CardHeader>
  <CardTitle className="flex items-center justify-between">
    <span>Prompt (Version {currentVersion}/3)</span>
    <div className="flex gap-2">
      <Button variant="ghost" size="sm" onClick={() => setVersion(1)}>
        <History className="h-4 w-4" />
        å†å²ç‰ˆæœ¬
      </Button>
      <Button variant="ghost" size="sm" onClick={() => resetToOriginal()}>
        <RotateCcw className="h-4 w-4" />
        æ¢å¤åŸå§‹
      </Button>
    </div>
  </CardTitle>
</CardHeader>
```

---

#### å»ºè®® 4ï¼šæ‰¹é‡è®¾ç½®ç®¡ç†ï¼ˆBatch Settingsï¼‰

**ä¸šåŠ¡åœºæ™¯**ï¼š
```
ç”¨æˆ·æƒ³ç”Ÿæˆ 20 å¼ ä¸åŒåˆ†è¾¨ç‡çš„å›¾ç‰‡ï¼š
- å‰ 10 å¼ ï¼š1:1 æ¯”ä¾‹ï¼Œ1K åˆ†è¾¨ç‡
- å 10 å¼ ï¼š16:9 æ¯”ä¾‹ï¼Œ4K åˆ†è¾¨ç‡

å½“å‰éœ€è¦æ‰‹åŠ¨åˆ‡æ¢ä¸¤æ¬¡ï¼Œå®¹æ˜“å‡ºé”™ã€‚
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

**UI è®¾è®¡**ï¼š
```tsx
<Card>
  <CardHeader>
    <CardTitle>Batch Generation Settings</CardTitle>
  </CardHeader>
  <CardContent>
    <div className="space-y-4">
      {/* Batch 1 */}
      <div className="border rounded-lg p-4">
        <h4 className="font-medium mb-2">Batch 1 (Images 1-10)</h4>
        <div className="grid grid-cols-2 gap-3">
          <Select label="Aspect Ratio" value="1:1" />
          <Select label="Resolution" value="1K" />
        </div>
      </div>

      {/* Batch 2 */}
      <div className="border rounded-lg p-4">
        <h4 className="font-medium mb-2">Batch 2 (Images 11-20)</h4>
        <div className="grid grid-cols-2 gap-3">
          <Select label="Aspect Ratio" value="16:9" />
          <Select label="Resolution" value="4K" />
        </div>
      </div>

      <Button onClick={() => addBatch()}>
        <Plus className="h-4 w-4 mr-2" />
        Add Another Batch
      </Button>
    </div>
  </CardContent>
</Card>
```

---

### 4.3 P2 çº§åˆ«ï¼ˆç”¨æˆ·ä½“éªŒå¢å¼ºï¼‰

#### å»ºè®® 5ï¼šå®æ—¶ Prompt é¢„è§ˆå·®å¼‚å¯¹æ¯”

**ä¸šåŠ¡åœºæ™¯**ï¼š
```
ç”¨æˆ·åˆ‡æ¢ Product State åï¼Œæ— æ³•ç›´è§‚çœ‹åˆ° Prompt æœ‰å“ªäº›å˜åŒ–ï¼Œ
éœ€è¦ä»”ç»†é˜…è¯»æ•´æ®µæ–‡å­—æ‰èƒ½å‘ç°å·®å¼‚ã€‚
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

**æŠ€æœ¯å®ç°**ï¼ˆä½¿ç”¨ diff ç®—æ³•ï¼‰ï¼š

```tsx
import { diffWords } from 'diff';

function PromptDiffView({ oldPrompt, newPrompt }) {
  const diff = diffWords(oldPrompt, newPrompt);

  return (
    <div className="font-mono text-sm">
      {diff.map((part, index) => (
        <span
          key={index}
          className={cn(
            part.added && "bg-green-200 text-green-800",
            part.removed && "bg-red-200 text-red-800 line-through"
          )}
        >
          {part.value}
        </span>
      ))}
    </div>
  );
}
```

**UX æ•ˆæœ**ï¼š
```
åˆ‡æ¢ FOLDED åï¼š

åŸ Prompt: "The walker reaches waist-height of a standing senior..."
æ–° Prompt: "The folded walker is COMPACT - only 66cm (26 inches) tall..."

é«˜äº®æ˜¾ç¤ºï¼š
- åˆ é™¤ï¼šreaches waist-height of a standing senior
- æ–°å¢ï¼šis COMPACT - only 66cm (26 inches) tall, about knee-height
```

---

#### å»ºè®® 6ï¼šæ™ºèƒ½å»ºè®®ç³»ç»Ÿï¼ˆAI Recommendationsï¼‰

**ä¸šåŠ¡åœºæ™¯**ï¼š
```
ç”¨æˆ·é€‰æ‹©äº†ï¼š
- Scene: Indoor > Bedroom
- Action: Walk

ç³»ç»Ÿæ™ºèƒ½æç¤ºï¼š
âš ï¸ é€šå¸¸åœ¨ Bedroom åœºæ™¯ä¸‹ï¼Œæ›´å¸¸è§çš„åŠ¨ä½œæ˜¯ "Stand" æˆ– "Rest"ã€‚
   æ˜¯å¦è€ƒè™‘è°ƒæ•´ï¼Ÿ
```

**æŠ€æœ¯å®ç°**ï¼š

**åŸºäºå†å²æ•°æ®çš„æ¨èå¼•æ“**ï¼š
```sql
-- ç»Ÿè®¡æœ€å¸¸è§çš„ Scene + Action ç»„åˆ
SELECT
  scene_code,
  action_code,
  COUNT(*) as frequency
FROM creative_projects
GROUP BY scene_code, action_code
ORDER BY frequency DESC
LIMIT 10;
```

**å‰ç«¯å±•ç¤º**ï¼š
```tsx
{showRecommendation && (
  <Alert variant="info">
    <Lightbulb className="h-4 w-4" />
    <AlertTitle>Smart Suggestion</AlertTitle>
    <AlertDescription>
      Based on 1,234 similar campaigns, "Rest" action performs 25% better
      than "Walk" in Bedroom scenes. <Button variant="link">Apply</Button>
    </AlertDescription>
  </Alert>
)}
```

---

### 4.4 P3 çº§åˆ«ï¼ˆé«˜çº§åŠŸèƒ½ï¼‰

#### å»ºè®® 7ï¼šA/B Test å¯¹æ¯”è§†å›¾

**ä¸šåŠ¡éœ€æ±‚**ï¼š
```
As a è¥é”€ç»ç†ï¼Œ
I want to å¯¹æ¯”ä¸¤ä¸ªä¸åŒ Product State çš„ç”Ÿæˆç»“æœï¼Œ
So that æˆ‘å¯ä»¥é€‰æ‹©æ•ˆæœæ›´å¥½çš„æ–¹æ¡ˆã€‚
```

**UI è®¾è®¡**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ A/B Test: UNFOLDED vs FOLDED                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ UNFOLDED (A)         â”‚ FOLDED (B)                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Prompt:          â”‚ â”‚ â”‚ Prompt:                      â”‚ â”‚
â”‚ â”‚ "waist-height... â”‚ â”‚ â”‚ "66cm compact..."            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                      â”‚                                  â”‚
â”‚ ğŸ–¼ï¸ [Image A1]       â”‚ ğŸ–¼ï¸ [Image B1]                   â”‚
â”‚ ğŸ–¼ï¸ [Image A2]       â”‚ ğŸ–¼ï¸ [Image B2]                   â”‚
â”‚ ğŸ–¼ï¸ [Image A3]       â”‚ ğŸ–¼ï¸ [Image B3]                   â”‚
â”‚ ğŸ–¼ï¸ [Image A4]       â”‚ ğŸ–¼ï¸ [Image B4]                   â”‚
â”‚                      â”‚                                  â”‚
â”‚ [Select Winner: A]   â”‚ [Select Winner: B]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æŠ€æœ¯å®ç°**ï¼š
```typescript
// æ–°å»ºé¡µé¢ï¼šapp/ab-test/page.tsx
export default function ABTestPage() {
  const [testA, setTestA] = useState<Session>();
  const [testB, setTestB] = useState<Session>();
  const [winner, setWinner] = useState<'A' | 'B' | null>(null);

  return (
    <div className="grid grid-cols-2 gap-6">
      <TestVariant
        variant="A"
        session={testA}
        onSelectWinner={() => setWinner('A')}
      />
      <TestVariant
        variant="B"
        session={testB}
        onSelectWinner={() => setWinner('B')}
      />
    </div>
  );
}
```

---

## äº”ã€æŠ€æœ¯å€ºåŠ¡ä¸æ¶æ„ä¼˜åŒ–

### 5.1 å½“å‰æŠ€æœ¯æ ˆè¯„ä¼°

| æŠ€æœ¯ | ç‰ˆæœ¬ | è¯„åˆ† | å¤‡æ³¨ |
|-----|------|------|------|
| Next.js | 14.x | A | App Router æ¶æ„ä¼˜ç§€ |
| React | 18.x | A | å·²ä½¿ç”¨ useCallback/useMemo ä¼˜åŒ– |
| Supabase | 2.39.0 | A | æ•°æ®åº“ + Storage ä¸€ä½“åŒ– |
| Gemini API | 2.0 Flash | B+ | å›¾ç‰‡ç”Ÿæˆè´¨é‡ä¸ç¨³å®š |
| Flux API | - | A | ä¸»åŠ›å›¾ç‰‡ç”Ÿæˆå¼•æ“ |
| Shadcn UI | - | A | ç»„ä»¶åº“å®Œå–„ |

### 5.2 æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### å»ºè®® 8ï¼šå›¾ç‰‡æ‡’åŠ è½½ä¸è™šæ‹ŸåŒ–

**å½“å‰é—®é¢˜**ï¼š
- ä¼šè¯ä¸­æœ‰ 100+ å¼ å›¾ç‰‡æ—¶ï¼Œå…¨éƒ¨æ¸²æŸ“å¯¼è‡´å¡é¡¿

**è§£å†³æ–¹æ¡ˆ**ï¼š

```tsx
import { useVirtualizer } from '@tanstack/react-virtual';

function ImageGallery({ images }) {
  const parentRef = useRef<HTMLDivElement>(null);

  const virtualizer = useVirtualizer({
    count: images.length,
    getScrollElement: () => parentRef.current,
    estimateSize: () => 200,  // æ¯å¼ å›¾ç‰‡é«˜åº¦
    overscan: 5,  // é¢„åŠ è½½ 5 å¼ å›¾ç‰‡
  });

  return (
    <div ref={parentRef} className="h-[600px] overflow-auto">
      <div style={{ height: `${virtualizer.getTotalSize()}px` }}>
        {virtualizer.getVirtualItems().map((virtualItem) => (
          <div
            key={virtualItem.key}
            style={{
              position: 'absolute',
              top: 0,
              left: 0,
              width: '100%',
              transform: `translateY(${virtualItem.start}px)`,
            }}
          >
            <Image src={images[virtualItem.index].url} loading="lazy" />
          </div>
        ))}
      </div>
    </div>
  );
}
```

---

#### å»ºè®® 9ï¼šAPI è¯·æ±‚ç¼“å­˜ç­–ç•¥

**å½“å‰é—®é¢˜**ï¼š
- ç”¨æˆ·åˆ‡æ¢å›ä¹‹å‰çš„ä¼šè¯æ—¶ï¼Œé‡æ–°åŠ è½½æ‰€æœ‰æ•°æ®

**è§£å†³æ–¹æ¡ˆ**ï¼š

```typescript
// ä½¿ç”¨ SWR æˆ– React Query ç¼“å­˜
import useSWR from 'swr';

function useSession(sessionId: string) {
  const { data, error, mutate } = useSWR(
    sessionId ? `/api/sessions/${sessionId}` : null,
    fetcher,
    {
      revalidateOnFocus: false,  // ä¸è‡ªåŠ¨é‡æ–°éªŒè¯
      dedupingInterval: 60000,   // 1 åˆ†é’Ÿå†…å»é‡
    }
  );

  return { session: data, isLoading: !data && !error, mutate };
}
```

---

### 5.3 ä»£ç è´¨é‡æ”¹è¿›

#### å»ºè®® 10ï¼šç±»å‹å®‰å…¨å¢å¼º

**å½“å‰é—®é¢˜**ï¼š
- éƒ¨åˆ† API å“åº”æœªå®šä¹‰ä¸¥æ ¼ç±»å‹

**æ”¹è¿›æ–¹æ¡ˆ**ï¼š

```typescript
// lib/types/api.ts - ç»Ÿä¸€ API å“åº”ç±»å‹
export interface APIResponse<T> {
  success: boolean;
  data?: T;
  error?: {
    code: string;
    message: string;
    details?: string;
  };
}

export interface SessionDetailResponse {
  id: string;
  creative_name: string;
  abcd_selection: ABCDSelection;
  prompt: string;
  product_state: ProductState;
  reference_image_url: string;
  images: GeneratedImageRecord[];
  status: SessionStatus;
  created_at: string;
  updated_at: string;
}

// ä½¿ç”¨ç¤ºä¾‹
const response = await fetch(`/api/sessions/${id}`);
const data: APIResponse<SessionDetailResponse> = await response.json();
```

---

## å…­ã€æ•°æ®å¯è§†åŒ–ä¸åˆ†æéœ€æ±‚

### å»ºè®® 11ï¼šä½¿ç”¨æƒ…å†µä»ªè¡¨æ¿

**ä¸šåŠ¡ä»·å€¼**ï¼š
```
è¿è¥å›¢é˜Ÿéœ€è¦äº†è§£ï¼š
1. å“ªäº› ABCD ç»„åˆæœ€å¸¸ç”¨ï¼Ÿ
2. å“ªäº› Product State ç”ŸæˆæˆåŠŸç‡æ›´é«˜ï¼Ÿ
3. ç”¨æˆ·å¹³å‡æ¯æ¬¡ç”Ÿæˆå¤šå°‘å¼ å›¾ç‰‡ï¼Ÿ
```

**æŠ€æœ¯å®ç°**ï¼š

**æ•°æ®èšåˆ SQL**ï¼š
```sql
-- æœ€å¸¸ç”¨çš„ Action
SELECT
  action_code,
  COUNT(*) as usage_count,
  AVG(CASE WHEN status = 'completed' THEN 1 ELSE 0 END) as success_rate
FROM creative_projects
GROUP BY action_code
ORDER BY usage_count DESC;

-- Product State åˆ†å¸ƒ
SELECT
  product_state,
  COUNT(*) as total_sessions,
  SUM(total_images) as total_images_generated
FROM creative_projects
GROUP BY product_state;
```

**Dashboard UI**ï¼š
```tsx
<Card>
  <CardHeader>
    <CardTitle>Usage Analytics</CardTitle>
  </CardHeader>
  <CardContent>
    <div className="grid grid-cols-3 gap-4">
      <StatCard
        title="Total Sessions"
        value="1,234"
        trend="+12% vs last week"
      />
      <StatCard
        title="Images Generated"
        value="24,680"
        trend="+8% vs last week"
      />
      <StatCard
        title="Success Rate"
        value="94.2%"
        trend="+2% vs last week"
      />
    </div>

    <div className="mt-6">
      <h3 className="text-sm font-medium mb-3">Top Actions</h3>
      <BarChart data={topActions} />
    </div>
  </CardContent>
</Card>
```

---

## ä¸ƒã€å®æ–½è·¯çº¿å›¾

### Phase 1: ç´§æ€¥ä¿®å¤ï¼ˆ1 å‘¨ï¼‰

**ç›®æ ‡**ï¼šè§£å†³æ ¸å¿ƒåŠŸèƒ½ç¼ºé™·

| ä»»åŠ¡ | å·¥ä½œé‡ | è´Ÿè´£äºº | ä¼˜å…ˆçº§ |
|-----|-------|-------|--------|
| å®ç° Product State åˆ‡æ¢é‡æ–°ç”Ÿæˆ Prompt | 2 å¤© | å‰ç«¯å·¥ç¨‹å¸ˆ | **P0** |
| éªŒè¯å¹¶ä¿®å¤ "Beside" åŠ¨ä½œæ˜ å°„ | 1 å¤© | åç«¯å·¥ç¨‹å¸ˆ + äº§å“ | P0 |
| æ·»åŠ  Prompt é‡æ–°ç”Ÿæˆ Loading çŠ¶æ€ | 0.5 å¤© | å‰ç«¯å·¥ç¨‹å¸ˆ | P0 |
| å¢åŠ  actions è¡¨ `product_state` å­—æ®µ | 1 å¤© | åç«¯å·¥ç¨‹å¸ˆ | P1 |
| æµ‹è¯•ä¸éªŒè¯ | 1.5 å¤© | QA | P0 |

**éªŒæ”¶æ ‡å‡†**ï¼š
1. âœ… ç”¨æˆ·åˆ‡æ¢ Product State åï¼ŒPrompt è‡ªåŠ¨æ›´æ–°
2. âœ… "Beside" åŠ¨ä½œæ­£ç¡®æ˜ å°„åˆ° FOLDED
3. âœ… åˆ‡æ¢è¿‡ç¨‹ä¸­æœ‰æ˜ç¡®çš„ Loading æç¤º
4. âœ… æ‰€æœ‰ç°æœ‰åŠŸèƒ½ä¸å—å½±å“

---

### Phase 2: åŠŸèƒ½å¢å¼ºï¼ˆ2 å‘¨ï¼‰

**ç›®æ ‡**ï¼šæå‡ç”¨æˆ·ä½“éªŒ

| ä»»åŠ¡ | å·¥ä½œé‡ | ä¼˜å…ˆçº§ |
|-----|-------|--------|
| Prompt å†å²ç‰ˆæœ¬ç®¡ç† | 3 å¤© | P1 |
| Batch Settings æ‰¹é‡è®¾ç½® | 3 å¤© | P1 |
| å®æ—¶ Prompt å·®å¼‚å¯¹æ¯” | 2 å¤© | P2 |
| å›¾ç‰‡æ‡’åŠ è½½ä¼˜åŒ– | 2 å¤© | P2 |
| API è¯·æ±‚ç¼“å­˜ç­–ç•¥ | 2 å¤© | P2 |

---

### Phase 3: é«˜çº§åŠŸèƒ½ï¼ˆ4 å‘¨ï¼‰

**ç›®æ ‡**ï¼šæ•°æ®é©±åŠ¨ä¸æ™ºèƒ½åŒ–

| ä»»åŠ¡ | å·¥ä½œé‡ | ä¼˜å…ˆçº§ |
|-----|-------|--------|
| A/B Test å¯¹æ¯”è§†å›¾ | 5 å¤© | P3 |
| æ™ºèƒ½æ¨èç³»ç»Ÿ | 7 å¤© | P3 |
| ä½¿ç”¨æƒ…å†µä»ªè¡¨æ¿ | 5 å¤© | P3 |
| æ€§èƒ½ç›‘æ§ä¸å‘Šè­¦ | 3 å¤© | P3 |

---

## å…«ã€é£é™©è¯„ä¼°ä¸ç¼“è§£æªæ–½

### 8.1 æŠ€æœ¯é£é™©

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|-----|------|------|---------|
| Gemini API ä¸ç¨³å®š | é«˜ | ä¸­ | å¢åŠ é‡è¯•æœºåˆ¶ + é™çº§åˆ° Flux |
| å¤§é‡å›¾ç‰‡å­˜å‚¨æˆæœ¬ | ä¸­ | é«˜ | å®ç°å›¾ç‰‡å‹ç¼© + æ—§å›¾ç‰‡è‡ªåŠ¨å½’æ¡£ |
| å¹¶å‘ç”Ÿæˆå†²çª | ä¸­ | ä½ | æ•°æ®åº“é”å®šæœºåˆ¶ï¼ˆå·²å®ç°ï¼‰ |
| å‰ç«¯æ€§èƒ½ä¸‹é™ | ä½ | ä¸­ | è™šæ‹ŸåŒ–åˆ—è¡¨ + æ‡’åŠ è½½ |

---

### 8.2 ä¸šåŠ¡é£é™©

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|-----|------|------|---------|
| ç”¨æˆ·æœŸæœ›ä¸ AI èƒ½åŠ›ä¸åŒ¹é… | é«˜ | ä¸­ | å¢åŠ  Prompt ç¼–è¾‘è‡ªç”±åº¦ + è´¨é‡è¯„åˆ† |
| ABCD ç»„åˆçˆ†ç‚¸ï¼ˆæ•°æ®ç®¡ç†å¤æ‚ï¼‰ | ä¸­ | é«˜ | æ•°æ®åº“å½’ä¸€åŒ– + æ¨èç³»ç»Ÿ |
| ç«å“å¿«é€Ÿè¿­ä»£ | é«˜ | ä¸­ | æŒç»­æ”¶é›†ç”¨æˆ·åé¦ˆ + å¿«é€Ÿè¿­ä»£ |

---

## ä¹ã€æˆåŠŸæŒ‡æ ‡ä¸éªŒè¯è®¡åˆ’

### 9.1 æ ¸å¿ƒæŒ‡æ ‡

| æŒ‡æ ‡ | å½“å‰å€¼ | ç›®æ ‡å€¼ï¼ˆ3 ä¸ªæœˆåï¼‰ | æµ‹é‡æ–¹å¼ |
|-----|-------|-------------------|----------|
| Prompt é‡æ–°ç”ŸæˆæˆåŠŸç‡ | N/A | >98% | åŸ‹ç‚¹ç»Ÿè®¡ |
| ç”¨æˆ·æ‰‹åŠ¨ç¼–è¾‘ Prompt æ¯”ä¾‹ | ~60% | <40% | ç”¨æˆ·è¡Œä¸ºåˆ†æ |
| å¹³å‡ä¼šè¯ç”Ÿæˆå›¾ç‰‡æ•° | ~8 å¼  | >20 å¼  | æ•°æ®åº“ç»Ÿè®¡ |
| ä¼šè¯å¤ç”¨ç‡ï¼ˆç»§ç»­ç”Ÿæˆï¼‰ | ~15% | >30% | æ•°æ®åº“ç»Ÿè®¡ |
| ç”¨æˆ· NPS åˆ†æ•° | N/A | >40 | ç”¨æˆ·è°ƒç ” |

---

### 9.2 éªŒè¯è®¡åˆ’

#### Week 1: Alpha æµ‹è¯•
- **å¯¹è±¡**ï¼šå†…éƒ¨å›¢é˜Ÿï¼ˆ5 äººï¼‰
- **ç›®æ ‡**ï¼šéªŒè¯ Product State åˆ‡æ¢é€»è¾‘æ­£ç¡®æ€§
- **æ–¹æ³•**ï¼šæ‰‹åŠ¨æµ‹è¯•æ‰€æœ‰ ABCD ç»„åˆ

#### Week 2-3: Beta æµ‹è¯•
- **å¯¹è±¡**ï¼šç§å­ç”¨æˆ·ï¼ˆ20 äººï¼‰
- **ç›®æ ‡**ï¼šæ”¶é›†çœŸå®ä½¿ç”¨åé¦ˆ
- **æ–¹æ³•**ï¼šé—®å·è°ƒæŸ¥ + è¡Œä¸ºæ•°æ®åˆ†æ

#### Week 4: å…¨é‡å‘å¸ƒ
- **å¯¹è±¡**ï¼šæ‰€æœ‰ç”¨æˆ·
- **ç›®æ ‡**ï¼šç›‘æ§ç³»ç»Ÿç¨³å®šæ€§
- **æ–¹æ³•**ï¼šå®æ—¶ç›‘æ§ + é”™è¯¯å‘Šè­¦

---

## åã€ç»“è®ºä¸ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### 10.1 æ ¸å¿ƒå‘ç°æ€»ç»“

1. **å…³é”®ç¼ºé™·**ï¼šProduct State åˆ‡æ¢å Prompt ä¸æ›´æ–° â†’ **å¿…é¡»ç«‹å³ä¿®å¤ï¼ˆP0ï¼‰**
2. **æ¶æ„ä¼˜åŠ¿**ï¼šä¼šè¯ç³»ç»Ÿè®¾è®¡ä¼˜ç§€ï¼Œæ”¯æŒå®Œæ•´çš„ç”Ÿæˆç”Ÿå‘½å‘¨æœŸç®¡ç†
3. **æŠ€æœ¯å€ºåŠ¡**ï¼šå¯æ§ï¼Œä¸»è¦åœ¨æ€§èƒ½ä¼˜åŒ–å’Œç±»å‹å®‰å…¨å±‚é¢
4. **ç”¨æˆ·ä»·å€¼**ï¼šABCD æ¡†æ¶æœ‰æ•ˆé™ä½åˆ›æ„é—¨æ§›ï¼Œä½†éœ€è¦æ›´æ™ºèƒ½çš„è¾…åŠ©åŠŸèƒ½

---

### 10.2 ç«‹å³è¡ŒåŠ¨é¡¹ï¼ˆNext 7 Daysï¼‰

#### æŠ€æœ¯å›¢é˜Ÿ
1. **å‰ç«¯**ï¼ˆä¼˜å…ˆçº§ P0ï¼‰ï¼š
   - [ ] å®ç° `handleProductStateChange()` å‡½æ•°
   - [ ] å¢åŠ  Prompt é‡æ–°ç”Ÿæˆ Loading çŠ¶æ€
   - [ ] æµ‹è¯•æ‰€æœ‰ Product State åˆ‡æ¢åœºæ™¯

2. **åç«¯**ï¼ˆä¼˜å…ˆçº§ P0ï¼‰ï¼š
   - [ ] éªŒè¯æ•°æ®åº“ `actions.product_state` å­—æ®µæ˜¯å¦å­˜åœ¨
   - [ ] å¦‚ä¸å­˜åœ¨ï¼Œæ‰§è¡Œè¿ç§»è„šæœ¬æ·»åŠ è¯¥å­—æ®µ
   - [ ] ä¿®æ”¹ `/api/generate-prompt` æ”¯æŒ `overrideProductState` å‚æ•°

3. **QA**ï¼ˆä¼˜å…ˆçº§ P0ï¼‰ï¼š
   - [ ] ç¼–å†™æµ‹è¯•ç”¨ä¾‹è¦†ç›–æ‰€æœ‰ ABCD ç»„åˆ
   - [ ] éªŒè¯ "Beside" åŠ¨ä½œæ­£ç¡®æ˜ å°„åˆ° FOLDED
   - [ ] å›å½’æµ‹è¯•ç°æœ‰åŠŸèƒ½

#### äº§å“å›¢é˜Ÿ
1. **éœ€æ±‚ç¡®è®¤**ï¼ˆä¼˜å…ˆçº§ P1ï¼‰ï¼š
   - [ ] ç¡®è®¤ "Beside" çš„ä¸šåŠ¡è¯­ä¹‰ï¼ˆFOLDED æ˜¯å¦æ­£ç¡®ï¼‰
   - [ ] æ”¶é›†ç”¨æˆ·å¯¹ Prompt ç¼–è¾‘çš„åé¦ˆ
   - [ ] åˆ¶å®š Phase 2 åŠŸèƒ½ä¼˜å…ˆçº§

2. **æ–‡æ¡£æ›´æ–°**ï¼ˆä¼˜å…ˆçº§ P2ï¼‰ï¼š
   - [ ] æ›´æ–°ç”¨æˆ·æ‰‹å†Œï¼Œè¯´æ˜ Product State åˆ‡æ¢é€»è¾‘
   - [ ] åˆ›å»º ABCD æœ€ä½³å®è·µæŒ‡å—

---

### 10.3 é•¿æœŸæˆ˜ç•¥å»ºè®®

1. **æ•°æ®é©±åŠ¨å†³ç­–**ï¼š
   - å»ºç«‹å®Œå–„çš„ä½¿ç”¨æƒ…å†µä»ªè¡¨æ¿
   - åŸºäºå†å²æ•°æ®ä¼˜åŒ– ABCD æ¨è

2. **AI èƒ½åŠ›å¢å¼º**ï¼š
   - æ¢ç´¢ Gemini Pro Vision ç”¨äºå›¾ç‰‡è´¨é‡è¯„ä¼°
   - å®ç°åŸºäºç”¨æˆ·åé¦ˆçš„ Prompt è‡ªä¼˜åŒ–

3. **ç”Ÿæ€ç³»ç»Ÿå»ºè®¾**ï¼š
   - å¼€æ”¾ API ç»™å¤–éƒ¨è¥é”€å·¥å…·
   - æ„å»º ABCD æ¨¡æ¿å¸‚åœº

---

## é™„å½•

### A. ç›¸å…³æ–‡ä»¶æ¸…å•

| æ–‡ä»¶è·¯å¾„ | å…³é”®å†…å®¹ | ä¼˜å…ˆçº§ |
|---------|---------|--------|
| `/app/page.tsx` | ä¸»é¡µé¢é€»è¾‘ï¼ŒåŒ…å« Product State åˆ‡æ¢ | P0 |
| `/lib/services/gemini-service.ts` | Prompt ç”Ÿæˆé€»è¾‘ï¼ŒState Router | P0 |
| `/app/api/generate-prompt/route.ts` | Prompt ç”Ÿæˆ API | P0 |
| `/lib/constants/abcd-matrix.ts` | ABCD å¸¸é‡å®šä¹‰ï¼ˆæ—§ç‰ˆï¼‰ | P2 |
| `/components/creative/abcd-selector.tsx` | ABCD é€‰æ‹©å™¨ç»„ä»¶ | P1 |

---

### B. æ•°æ®åº“ Schema æ£€æŸ¥æ¸…å•

```sql
-- 1. æ£€æŸ¥ actions è¡¨æ˜¯å¦æœ‰ product_state å­—æ®µ
SELECT column_name, data_type
FROM information_schema.columns
WHERE table_name = 'actions';

-- 2. æ£€æŸ¥ product_state å­—æ®µå€¼åˆ†å¸ƒ
SELECT product_state, COUNT(*)
FROM actions
GROUP BY product_state;

-- 3. æ£€æŸ¥ä¼šè¯è¡¨çš„ prompt_history å­—æ®µï¼ˆå¦‚éœ€å®ç°ï¼‰
SELECT column_name
FROM information_schema.columns
WHERE table_name = 'creative_projects'
  AND column_name = 'prompt_history';
```

---

### C. è”ç³»äººä¸è´£ä»»åˆ†å·¥

| è§’è‰² | å§“å | èŒè´£ | è”ç³»æ–¹å¼ |
|-----|------|------|---------|
| Product Director | - | éœ€æ±‚å®šä¹‰ã€ä¼˜å…ˆçº§æ’åº | - |
| Frontend Lead | - | å‰ç«¯å®ç°ã€æ€§èƒ½ä¼˜åŒ– | - |
| Backend Lead | - | API å¼€å‘ã€æ•°æ®åº“è¿ç§» | - |
| QA Lead | - | æµ‹è¯•è®¡åˆ’ã€è´¨é‡ä¿éšœ | - |

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**æœ€åæ›´æ–°**: 2025-12-08
**ä¸‹æ¬¡è¯„å®¡**: 2025-12-15ï¼ˆP0 ä»»åŠ¡å®Œæˆåï¼‰

---

**å®¡æ‰¹æµç¨‹**ï¼š
- [ ] äº§å“è´Ÿè´£äººå®¡æ‰¹
- [ ] æŠ€æœ¯è´Ÿè´£äººå®¡æ‰¹
- [ ] QA è´Ÿè´£äººå®¡æ‰¹
- [ ] æ‰§è¡Œå›¢é˜Ÿç¡®è®¤

**å¤‡æ³¨**ï¼šæœ¬æ–‡æ¡£åŸºäº 2025-12-08 çš„ä»£ç çŠ¶æ€åˆ†æï¼Œåç»­éœ€æ ¹æ®å®é™…å®æ–½æƒ…å†µåŠ¨æ€æ›´æ–°ã€‚
